colnames(df)[i] = new_names[i]
}
df = df[order(df$mun), ]
df[df$mun=='Jundiaí'& df$ano==2007,'ite'] = 100
sp = read_municipality(code_muni = 'SP')
sp = sp[order(sp$name_muni), ]
explore = function(df, x){
for(i in 0:18){
cat('Ano:', 2000+i, '\n')
print(summary(df[df$ano==2000+i, x ]))
}
}
explore2 = function(df, x){
a = matrix(nrow=19, ncol=8)
for(i in 0:18){
#cat('Ano:', 2000+i, '\n')
a[i+1,1:7] = summary(df[df$ano==2000+i, x ])
a[i+1,8] = 2000+i
}
a = data.frame(a)
colnames(a) = c('Min.', '1st Qu.', 'Median', 'Mean', '3rd Qu.', 'Max.', 'NAs', 'ano')
return(a)
}
# ite e ice
df2 =  df[df$ano==2018, c('ice', 'ite')]
data = melt(data = df2)
colnames(data)[1] = 'Índice'
g0 = ggplot(data = data, aes(x=value))
g1 = g0 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack') +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
df3 = data.frame( df[df$ano==2018, c('iata')] )
df3$Índice = rep('IATA', nrow(df3))
colnames(df3)[1] = 'IATA'
g2 = ggplot(data = df3, aes(x=IATA))
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack') +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0,100, 20)) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
) +
scale_x_continuous(breaks=seq(0,100, 20))
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0,100, 20)) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0,100, 20), binwidth=6) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
binwidth=6) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3 = g2 +  geom_histogram(binwidth = 6,  aes(fill=Índice),
colour='black', position = 'stack',
) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
break=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
break=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3 = g2 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 6,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 7,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 7,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 8,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram(binwidth = 9,  aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g3 = g2 +  geom_histogram( aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
seq(0, 100, 20)
g3 = g2 +  geom_histogram( aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20) ) +
scale_x_continuous(breaks=seq(0,100,20)) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
g1 = g0 +  geom_histogram(binwidth = 10,  aes(fill=Índice),
colour='black', position = 'stack') +
scale_x_continuous(breaks=seq(0,100,20)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 20)) +
scale_x_continuous(breaks=seq(0,100,20)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
ggsave('g1.png')
g3 = g2 +  geom_histogram( aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10) ) +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
theme_minimal() +
theme(legend.position='none')
g3
ggsave('g3.png')
library(sf)
library(geobr)
library(ggplot2)
library(readxl)
library(ggspatial)
library(magrittr)
library(raster)
library(tmap)
library(reshape2)
library("writexl")
## dados
df = read_excel('esg_agua.xlsx')
df = as.data.frame(df)
#### rename
or_names = colnames(df)
new_names = c('cod', 'mun', 'est', 'ano', 'prest', 'serv', 'pop_urb_a', 'pop_urb_e',
'pop_urb_aI', 'pop_urb_eI', 'pop_tot', 'pop_urb', 'pop_tot_a', 'pop_urb_a',
'pop_tot_e', 'pop_urb_e', 'ice', 'ite', 'iaua', 'iauera', 'iauere', 'iata', 'iatera')
## print os velhos e novos nomes das colunas
pnames = function(){
for (i in 1:length(or_names)) {
cat( or_names[i], '----- Novo nome:', new_names[i], '\n')
}
}
pnames()
# renomeando
for (i in 1:length(new_names)) {
colnames(df)[i] = new_names[i]
}
df = df[order(df$mun), ]
df[df$mun=='Jundiaí'& df$ano==2007,'ite'] = 100
## change variables
#df$pop_tot_a  = df$pop_tot_a / df$pop_tot
#df$pop_tot_e  = df$pop_tot_e / df$pop_tot
# geocode
sp = read_municipality(code_muni = 'SP')
sp = sp[order(sp$name_muni), ]
## summary
explore = function(df, x){
for(i in 0:18){
cat('Ano:', 2000+i, '\n')
print(summary(df[df$ano==2000+i, x ]))
}
}
explore2 = function(df, x){
a = matrix(nrow=19, ncol=8)
for(i in 0:18){
#cat('Ano:', 2000+i, '\n')
a[i+1,1:7] = summary(df[df$ano==2000+i, x ])
a[i+1,8] = 2000+i
}
a = data.frame(a)
colnames(a) = c('Min.', '1st Qu.', 'Median', 'Mean', '3rd Qu.', 'Max.', 'NAs', 'ano')
return(a)
}
maps_f = function(x){
for (i in 0:18) {
filt = df$ano == (2000+i)
sp$var = df[filt,x ]
g1 =  tm_shape(sp) +
tm_polygons('var',  title=toupper(x),  textNA = 'Sem dados') +
tm_compass(type = "8star", position = c("right", "bottom", size = 0.0)) +
tm_scale_bar(breaks = c(0, 100, 200, 300), text.size = 0.6) +
tm_layout(
legend.text.size = 0.8,
frame = T,
legend.format = list(text.separator = "-"))
nam =  paste("G_", i, sep = "")
assign(nam, g1)
tmap_save(g1, filename = paste("G_",x, i, ".png", sep = "") )
}
}
df2 =  df[df$ano==2018, c('ice', 'ite')]
data = melt(data = df2)
colnames(data)[1] = 'Índice'
g0 = ggplot(data = data, aes(x=value))
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
stat_bin(binwidth=1, geom='text', color='white', aes(label=..count..),
position=position_stack(vjust = 0.5)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
stat_bin(binwidth=1, geom='text', color='black', aes(label=count),
position=position_stack(vjust = 0.5)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
stat_bin(binwidth=1, geom='text', color='black', aes(label=..count..),
position=position_stack(vjust = 0.5)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
stat_bin(binwidth=1, geom='text', color='black', aes(label=..count..),
) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
stat_bin(binwidth=1, geom='text', color='black', aes(label=..count..),
) +
geom_bar(stat = "identity") +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_histogram(aes(fill=Índice),
colour='black', position = 'stack',
breaks=seq(0, 100, 10)) +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 = ggplot(data = data, aes(x=value, fill=Índice))
g1 = g0 +  geom_bar(stat = "identity")  +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 = ggplot(data = data, aes(x=value,y=y,  fill=Índice))
g1 = g0 +  geom_bar(stat = "identity")  +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 = ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))
g1 = g0 +  geom_bar(stat = "identity")  +
scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_bar(stat = "identity")  +
#  scale_x_continuous(breaks=seq(0,100,10)) +
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +  geom_bar(stat = "identity")  +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)))+
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)))+
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 = ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)))+
ylab('Quantidade de municípios') +
xlab('Índices') +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)))+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)), aes(fill=Índice) )+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 = ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)), aes(fill=Índice) )+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)), aes(fill=Índice) )+
geom_bar(stat='identity') +
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)),
aes(fill=Índice), stat='identity' )+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)),
aes(fill=Índice), stat='count' )+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g1 = g0 +
geom_histogram(binwidth=1e5, position=position_dodge(1e5-20*(1e3)),
aes(fill=Índice, geom_bar(stat='identity')) )+
ylab('Quantidade de municípios') +
xlab('Índices') +
scale_x_continuous(labels=scales::comma, breaks=seq(0, 2e6, by = 1e5)) +
theme_minimal() +
scale_fill_discrete( labels = c("ICE", "ITE"))
g1
g0 =
ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))
g0 =
ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))+
geom_bar(stat = "identity")
ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))+
geom_bar(stat = "identity")
g0 =
ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))+
geom_bar(stat = "count")
g0 =
ggplot(data = data, aes(x=value,y=Índice,  fill=Índice))+
geom_bar(stat = "count")
g0 =
ggplot(data = data, aes(x=value,  fill=Índice))+
geom_bar(stat = "count")
ggplot(data = data, aes(x=value,  fill=Índice))+
geom_bar(stat = "count")
View(data)
View(df2)
cut(df2, breaks=c(0, 50, 100))
cut(df2$ice, breaks=c(0, 50, 100))
table( cut(df2$ice, breaks=c(0, 50, 100)) )
table( cut(df2$ice, breaks=seq(0, 100, 20) ) )
table( cut(df2$ice, breaks=seq(0, 100, 10) ) )
hist(table( cut(df2$ice, breaks=seq(0, 100, 10) ) ) )
View(data)
ite =
ggplot2.histogram(data=data, xName='weight',
groupName='Índice', legendPosition="top")
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
library(easyGgplot2)
install_github("easyGgplot2", "kassambara")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(devtools)
ite =
install.packages("glue")
install.packages("glue")
install.packages("glue")
install.packages("devtools")
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
install_github("easyGgplot2", "kassambara")
